<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <style>
        #hm2_cl *,
        ::after,
        ::before {
            box-sizing: border-box;
        }

        #hm2_cl {
            line-height: 1.5;
            font-family: 'Roboto', sans-serif;
        }

        #hm2_cl .container {
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
            margin-right: auto;
            margin-left: auto;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #080337;
            text-align: left;
        }

        #hm2_cl label {
            display: block;
            margin-bottom: .5rem;
            font-size: 14px;
            font-weight: 500;
        }

        #hm2_cl .table {
            width: 100%;
            max-width: 100%;
            margin-bottom: 0rem;
            background-color: transparent;
            border-collapse: collapse;
        }

        #hm2_cl .sp-table {
            width: 100%;
            max-width: 100%;
            margin-bottom: 0rem;
            background-color: transparent;
            border-collapse: collapse;
        }

        #hm2_cl .table td,
        #hm2_cl .table th {
            padding: 0 3px;
            vertical-align: middle;
            border-right: none !important;
            border-left: none !important;
            border-top: none !important;
            font-size: 16px;
            background: transparent;
            box-shadow: none;
            color: #000000;
        }

        #hm2_cl .sp-table td {
            padding: .65rem .75rem;
            vertical-align: middle;
            border-right: none !important;
            border-left: none !important;
            border-top: none !important;
            border-bottom: none;
            font-size: 16px;
            background: transparent;
            box-shadow: none;
            color: #000000;
        }

        #hm2_cl .sp-table th {
            padding: .65rem .75rem;
            vertical-align: middle;
            border-right: none !important;
            border-left: none !important;
            border-top: none !important;
            border-bottom: 1px solid #6BC14B;
            font-size: 16px;
            background: transparent;
            box-shadow: none;
            color: #000000;
        }

        #hm2_cl .table th {
            text-align: left;
            font-weight: 500;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl h3,
        h4,
        p {
            margin: 10px 0;
        }

        #hm2_cl .row {
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            margin-right: -15px;
            margin-left: -15px;
        }

        #hm2_cl .col-md-1,
        #hm2_cl .col-md-10,
        #hm2_cl .col-md-11,
        #hm2_cl .col-md-12,
        #hm2_cl .col-md-2,
        #hm2_cl .col-md-3,
        #hm2_cl .col-md-4,
        #hm2_cl .col-md-5,
        #hm2_cl .col-md-6,
        #hm2_cl .col-md-7,
        #hm2_cl .col-md-8,
        #hm2_cl .col-md-9 {
            position: relative;
            width: 100%;
            padding-right: 15px;
            padding-left: 15px;
        }

        #hm2_cl .form-group {
            margin-bottom: 1rem;
        }

        #hm2_cl .form-control {
            display: block;
            width: 100%;
            height: 40px;
            padding: .375rem .75rem;
            font-size: 16px;
            font-weight: 400;
            line-height: 1.5;
            color: #080337;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: .25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        #hm2_cl .tb-form-control {
            display: block;
            width: 100%;
            height: 40px;
            padding: .375rem .75rem;
            font-size: 16px;
            font-weight: 400;
            line-height: 1.5;
            color: #080337;
            background-color: #fff;
            background-clip: padding-box;
            border: none;
            border-bottom: 1px solid #D9D9D9;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        #hm2_cl select.tb-form-control {
            visibility: visible !important;
            -webkit-appearance: auto !important;
        }

        #hm2_cl .form-control:focus {
            outline: none;
        }

        #hm2_cl .tb-form-control:focus {
            outline: none;
        }

        #hm2_cl .input-group {
            position: relative;
            display: -ms-flexbox;
            display: flex;
            -ms-flex-wrap: wrap;
            flex-wrap: wrap;
            -ms-flex-align: stretch;
            align-items: stretch;
            width: 100%;
            margin-bottom: 1rem;
        }

        #hm2_cl .input-group>.custom-select:not(:last-child),
        #hm2_cl .input-group>.form-control:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        #hm2_cl .input-group>.custom-file,
        #hm2_cl .input-group>.custom-select,
        #hm2_cl .input-group>.form-control,
        #hm2_cl .input-group>.form-control-plaintext {
            position: relative;
            -ms-flex: 1 1 0%;
            flex: 1 1 0%;
            min-width: 0;
            margin-bottom: 0;
        }

        #hm2_cl .input-group>.custom-select:not(:first-child),
        #hm2_cl .input-group>.form-control:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        #hm2_cl .input-group>.custom-select:not(:last-child),
        #hm2_cl .input-group>.form-control:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        #hm2_cl .input-group>.custom-file+.custom-file,
        #hm2_cl .input-group>.custom-file+.custom-select,
        #hm2_cl .input-group>.custom-file+.form-control,
        #hm2_cl .input-group>.custom-select+.custom-file,
        #hm2_cl .input-group>.custom-select+.custom-select,
        #hm2_cl .input-group>.custom-select+.form-control,
        #hm2_cl .input-group>.form-control+.custom-file,
        #hm2_cl .input-group>.form-control+.custom-select,
        #hm2_cl .input-group>.form-control+.form-control,
        #hm2_cl .input-group>.form-control-plaintext+.custom-file,
        #hm2_cl .input-group>.form-control-plaintext+.custom-select,
        #hm2_cl .input-group>.form-control-plaintext+.form-control {
            margin-left: -1px;
        }

        #hm2_cl .input-group>.custom-file,
        #hm2_cl .input-group>.custom-select,
        #hm2_cl .input-group>.form-control,
        #hm2_cl .input-group>.form-control-plaintext {
            position: relative;
            -ms-flex: 1 1 0%;
            flex: 1 1 0%;
            min-width: 0;
            margin-bottom: 0;
        }

        #hm2_cl .custom-control-label::before,
        #hm2_cl .custom-file-label,
        #hm2_cl .custom-select {
            transition: background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        #hm2_cl .input-group-append {
            margin-left: -1px;
        }

        #hm2_cl .input-group-append,
        #hm2_cl .input-group-prepend {
            display: -ms-flexbox;
            display: flex;
        }

        #hm2_cl .input-group>.input-group-append:last-child>.btn:not(:last-child):not(.dropdown-toggle),
        #hm2_cl .input-group>.input-group-append:last-child>.input-group-text:not(:last-child),
        #hm2_cl .input-group>.input-group-append:not(:last-child)>.btn,
        #hm2_cl .input-group>.input-group-append:not(:last-child)>.input-group-text,
        #hm2_cl .input-group>.input-group-prepend>.btn,
        #hm2_cl .input-group>.input-group-prepend>.input-group-text {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        #hm2_cl .input-group>.input-group-append>.btn,
        #hm2_cl .input-group>.input-group-append>.input-group-text,
        #hm2_cl .input-group>.input-group-prepend:first-child>.btn:not(:first-child),
        #hm2_cl .input-group>.input-group-prepend:first-child>.input-group-text:not(:first-child),
        #hm2_cl .input-group>.input-group-prepend:not(:first-child)>.btn,
        #hm2_cl .input-group>.input-group-prepend:not(:first-child)>.input-group-text {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        #hm2_cl .input-group-append .btn,
        #hm2_cl .input-group-prepend .btn {
            position: relative;
            z-index: 2;
        }

        #hm2_cl .input-group-text {
            display: -ms-flexbox;
            display: flex;
            -ms-flex-align: center;
            align-items: center;
            padding: 0.355rem 0.75rem;
            margin-bottom: 0;
            font-size: 1rem;
            font-weight: 400;
            line-height: 1.5;
            color: #080337;
            text-align: center;
            white-space: nowrap;
            background-color: #ffffff;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
        }

        #hm2_cl .input-group-append .btn+.btn,
        #hm2_cl .input-group-append .btn+.input-group-text,
        #hm2_cl .input-group-append .input-group-text+.btn,
        #hm2_cl .input-group-append .input-group-text+.input-group-text,
        #hm2_cl .input-group-prepend .btn+.btn,
        #hm2_cl .input-group-prepend .btn+.input-group-text,
        #hm2_cl .input-group-prepend .input-group-text+.btn,
        #hm2_cl .input-group-prepend .input-group-text+.input-group-text {
            margin-left: -1px;
        }

        #hm2_cl .input-group-prepend .btn,
        #hm2_cl .input-group-append .btn {
            position: relative;
            z-index: 2;
        }

        #hm2_cl .text-center {
            text-align: center !important;
        }

        /* Custom css */
        #hm2_cl .cl-wrapper {
            position: relative;
            border-radius: 10px;
            background: #ffffff;
            box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
        }

        #hm2_cl .cl-left-div {
            padding: 3rem 3rem 2rem 3rem !important;
            background: #ffffff;
            border-radius: 10px;
        }

        #hm2_cl .cl-right-div {
            padding: 2rem 3rem !important;
            border-radius: 0 0 8px 8px;
            background: #ffffff;
            color: #080337;
        }

        #hm2_cl .rs-sec {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            border-radius: 10px;
            padding: 1rem 0.5rem;
            margin: 6px 0;
            box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
        }

        #hm2_cl .rs-vl {
            text-align: right;
            font-weight: 500;
        }

        #hm2_cl .rs-sub-title-sp {
            font-size: 16px;
            margin: 2px;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl .rs-sp-value {
            font-size: 22px;
            margin: 8px 2px;
            color: #6BC14B;
        }

        #hm2_cl .sp-rs {
            color: #6BC14B;
        }

        #hm2_cl .btn {
            display: inline-block;
            font-weight: 400;
            color: #212529;
            text-align: center;
            vertical-align: middle;
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            background-color: transparent;
            border: 2px solid transparent;
            padding: 5px 60px;
            font-size: 18px;
            line-height: 32px;
            transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }

        #hm2_cl .btn-primary {
            color: #fff;
            background-color: #6BC14B;
            border-color: #6BC14B;
            text-decoration: none;
            padding: 3px 60px;
            font-size: 18px;
        }

        #hm2_cl .btn-primary:hover {
            color: #fff;
            background-color: #6BC14B;
            border-color: #6BC14B;
        }

        /* responsive */

        @media (max-width: 768px) {
            #hm2_cl .cl-left-div {
                padding: 1rem 2rem !important;
            }

            #hm2_cl .cl-right-div {
                padding: 2rem 1rem !important;
                border-radius: 0 0 8px 8px;
            }

            #hm2_cl .form-control {
                height: auto;
                padding: .175rem .75rem;
            }

            #hm2_cl label {
                font-size: 14px;
            }

            #hm2_cl .rs-sec {
                flex-direction: column;
            }

            #hm2_cl .btn-warning {
                padding: 1.1375rem 2rem;
                font-size: 1rem;
            }
        }

        @media (min-width: 576px) {

            #hm2_cl .container,
            #hm2_cl .container-sm {
                max-width: 540px;
            }
        }

        @media (min-width: 768px) {

            #hm2_cl .container,
            #hm2_cl .container-md,
            #hm2_cl .container-sm {
                max-width: 100%;
            }

            #hm2_cl .col-md-12 {
                -ms-flex: 0 0 100%;
                flex: 0 0 100%;
                max-width: 100%;
            }

            #hm2_cl .col-md-9 {
                -ms-flex: 0 0 75%;
                flex: 0 0 75%;
                max-width: 75%;
            }

            #hm2_cl .col-md-8 {
                -ms-flex: 0 0 66.666667%;
                flex: 0 0 66.666667%;
                max-width: 66.666667%;
            }

            #hm2_cl .col-md-6 {
                -ms-flex: 0 0 50%;
                flex: 0 0 50%;
                max-width: 50%;
            }

            #hm2_cl .col-md-4 {
                -ms-flex: 0 0 33.333333%;
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }

            #hm2_cl .col-md-3 {
                -ms-flex: 0 0 25%;
                flex: 0 0 25%;
                max-width: 25%;
            }

            #hm2_cl .col-md-2 {
                -ms-flex: 0 0 16.66667%;
                flex: 0 0 16.66667%;
                max-width: 16.66667%;
            }
        }

        @media (min-width: 992px) {

            #hm2_cl .container,
            #hm2_cl .container-lg,
            #hm2_cl .container-md,
            #hm2_cl .container-sm {
                max-width: 900px;
            }
        }

        @media (min-width: 1200px) {

            #hm2_cl .container,
            #hm2_cl .container-lg,
            #hm2_cl .container-md,
            #hm2_cl .container-sm,
            #hm2_cl .container-xl {
                max-width: 900px;
            }
        }

        #hm2_cl hr {
            border: none;
            border-bottom: 1px solid #ccc;
        }

        #hm2_cl .optios-sec {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
        }

        #hm2_cl .radio-option {
            display: flex;
            flex-direction: row;
            align-items: center;
            background: #ffffff;
            padding: 6px 10px;
            width: 50%;
            border-radius: 5px;
            border: 1px solid #ccc;
            text-align: center;
            cursor: pointer;
            color: #080337;
            transition: all 0.2s;
            font-size: 16px;
            user-select: none;
        }

        #hm2_cl .radio-option:hover {
            background: #dddddd;
            border: 1px solid #dddddd;
        }

        #hm2_cl .radio-option.active {
            background: #34D9E5;
            border: 1px solid #34D9E5;
            color: #ffffff;
        }

        #hm2_cl .circle-radio {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ffffff;
            border: 1px solid #b5b5b5;
            margin-right: 6px;
        }

        #hm2_cl .mr-right {
            margin-right: 5px;
        }

        #hm2_cl .ds-none {
            display: none;
        }

        #hm2_cl .rs-sec-title {
            font-size: 22px;
            text-align: center;
            border-bottom: 1px solid #ccc;
            padding-bottom: 8px;
            color: #26459E;
        }

        #hm2_cl .grow-logo {
            width: 70px;
            display: inline-block;
        }

        #hm2_cl .text-center {
            text-align: center;
        }

        #hm2_cl .top-title {
            font-size: 26px;
            text-align: center;
            margin: 10px 0 30px 0;
            color: #6bc14b;
        }

        #hm2_cl .top-logo {
            width: 200px;
            margin-top: -32px;
        }

        #hm2_cl .sec-top-title {
            font-size: 18px;
            font-weight: 400;
            color: #000000;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl .all-debts-sec-title {
            font-size: 18px;
            font-weight: 400;
            color: #000000;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl .new-loan-sec-title {
            font-size: 18px;
            font-weight: 400;
            color: #000000;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl .sp-txt-cl {
            color: #26459E !important;
            font-weight: 600;
        }

        #hm2_cl .rs-saving-sec {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            padding: 20px 20px;
            box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
            border-radius: 10px;
            margin: 0;
            margin-top: 15px;
            margin-bottom: 15px;
        }

        #hm2_cl .rs-saving-title {
            font-size: 20px;
            color: #26459E;
            font-weight: 600;
        }

        #hm2_cl .rs-saving-vl {
            font-size: 20px;
            color: #6BC14B;
            font-weight: 600;
            text-align: right;
        }

        #hm2_cl .debts-paid-sec-title {
            font-size: 18px;
            font-weight: 400;
            color: #000000;
            border-bottom: 1px solid #6BC14B;
        }

        #hm2_cl .middle-txt {
            font-size: 18px;
            font-weight: 400;
            color: #000000;
            text-align: center;
        }

        #hm2_cl .foorter-rs-sec {
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            #hm2_cl .sp-table td {
                padding: 3px;
                font-size: 13px;
            }
        }

        #pdf_data {
            position: relative;
            height: 100%;
        }

        #pdf_data .table {
            width: 100%;
            max-width: 100%;
            margin-bottom: 0rem;
            background-color: transparent !important;
            border-collapse: collapse !important;
        }

        #pdf_data .table td,
        #pdf_data .table th {
            padding: 2px 4px;
            vertical-align: middle;
            border-right: none !important;
            border-left: none !important;
            border-top: none !important;
            border-bottom: none !important;
            font-weight: 400;
            text-align: left;
            font-size: 12px !important;
            line-height: 20px;
            color: #000;
            background: transparent !important;
        }

        #pdf_data .table th {
            font-size: 14px !important;
            font-weight: 500;
            border-bottom: 1px solid #6BC14B !important;
        }

        #pdf_data #pdf_graph {
            height: 400px;
        }

        #pdf_section {
            display: none;
        }

        #pdf_data .top-row {
            background: #f6f6f6 !important;
        }

        #pdf_data .ds-none {
            display: none !important;
        }

        #pdf_data .text-right {
            text-align: right !important;
        }

        #pdf_data .text-center {
            text-align: center !important;
        }

        #pdf_data .text-left {
            text-align: left !important;
        }

        #pdf_data .f600 {
            font-weight: 600 !important;
        }

        #pdf_data .pdf-sv-title {
            font-size: 24px !important;
        }

        #pdf_data .pdf-sv-vl {
            font-size: 24px !important;
            color: #6BC14B;
            font-weight: 600 !important;
            text-align: right !important;
        }

        #pdf_data .pdf-rs-title {
            font-size: 18px !important;
            color: #26459E;
            text-align: center !important;
        }

        #pdf_data .pdf-rs-vl {
            font-size: 18px !important;
            color: #6BC14B !important;
            font-weight: 600 !important;
            text-align: center !important;
        }

        #pdf_data #loan_sec {
            margin-top: 10px;
            margin-bottom: 20px;
        }

        #pdf_data #value_sec {
            margin-bottom: 10px;
        }

        #pdf_data #new_loan_sec {
            margin-bottom: 10px;
        }

        #pdf_data #savings_sec {
            padding: 8px 10px;
            box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
            border-radius: 10px;
            margin-bottom: 10px;
        }

        #pdf_data #debts_paid_sec {
            margin-bottom: 10px;
        }

        #pdf_data #pdf_txt_sec {
            font-size: 20px;
            text-align: center;
            margin-bottom: 10px;
        }

        #pdf_data #footer_rs_sec {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        #pdf_data #bottom_footer_sec {
            margin-top: 20px;
            margin-bottom: 10px;
        }

        #pdf_data .pdf-loan-vl {
            text-align: right !important;
        }

        #pdf_data .top-logo {
            width: 180px;
        }
    </style>
    <div id="hm2_cl">
        <div class="container cl-wrapper">
            <div class="row">
                <div class="col-md-12 cl-left-div">
                    <p class="text-center">
                        <img class="top-logo" src="top-logo.png" alt=""
                            srcset="">
                        

                    </p>
                    <div class="col-md-12">
                        <label for="xmlUpload">Upload XML File</label>
                        <input type="file" id="xmlUpload" accept=".xml" class="form-control" style="display: none;">
                        <div id="dropZone" 
                             style="border: 2px dashed blue; padding: 20px; text-align: center; cursor: pointer; color: blue;">
                            Drag and drop an XML file here or click to upload
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h3 class="sec-top-title">New Loan</h3>
                            <div class="row">
                                <div class="col-md-12">
                                    <label for="hm2_in_1">New loan amount</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_4"
                                            value="">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label for="hm2_in_1">New Term (years)</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_5"
                                            value="">
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label for="hm2_in_1">New Rate</label>
                                    <div class="input-group">
                                        <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="hm2_in_6"
                                            value="">
                                        <div class="input-group-append">
                                            <span class="input-group-text">%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                
                                <div class="col-md-3">
                                    <label for="hm2_in_1">Taxes</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_8"
                                            value="">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="hm2_in_1">Insurance</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_9"
                                            value="">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="hm2_in_1">PMI</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_10"
                                            value="">
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="hm2_in_1">Extra Payment</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="extra_payment"
                                            value="">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 all-debts-sec">
                            <h3 class="all-debts-sec-title">All Debts</h3>
                            <div style="overflow-x: auto;">
                                <table class="table" style="min-width: 430px;">
                                    <thead>
                                        <tr>
                                            <th>Lender</th>
                                            <th>Payment</th>
                                            <th>Balance</th>
                                            <th style="min-width: 85px;">Paid at close?</th>
                                        </tr>
                                    </thead>
                                    <tbody id="all_debts_sec">
                                        <tr class="debts-row">
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <select name="" class="tb-form-control debts-in hm2_cl-input">
                                                    <option data-value="">--Select--</option>
                                                    <option data-value="Yes" selected>Yes</option>
                                                    <option data-value="No">No</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr class="debts-row">
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                    <option data-value="">--Select--</option>
                                                    <option data-value="Yes" selected>Yes</option>
                                                    <option data-value="No">No</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr class="debts-row">
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                    <option data-value="">--Select--</option>
                                                    <option data-value="Yes" selected>Yes</option>
                                                    <option data-value="No">No</option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr class="debts-row">
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <input type="text" class="tb-form-control debts-in hm2_cl-input"
                                                    value="">
                                            </td>
                                            <td>
                                                <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                    <option data-value="">--Select--</option>
                                                    <option data-value="Yes" selected>Yes</option>
                                                    <option data-value="No">No</option>
                                                </select>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button class="btn btn-secondary" id="add_debts_btn" style="margin-top: 25px;background-color: blue; color: white;">+ Add
                                debt</button>
                        </div>
                        <div class="col-md-12 middle-rs-sec">
                            <br>
                            <div class="row">
                                
                                
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">Total Current Debts to be paid
                                            </h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_3">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">New Outflow</h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_4">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 new-loan-sec">
                            <h3 class="new-loan-sec-title">New Loan:</h3>
                            <div style="overflow-x: auto;">
                                <table class="sp-table" id="debts_loan_tb">
                                    <thead>
                                        <tr>
                                            <th class="sp-txt-cl">Total Debts</th>
                                            <th class="sp-txt-cl">Proposed</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Minimum Payments (without Mortgage)</td>
                                            <td id="nl_rs_2">0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Mortgage Balance</td>
                                            <td id="nl_rs_4">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Time Left on Current Loan</td>
                                            <td id="nl_rs_6">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Taxes</td>
                                            <td id="nl_rs_8">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td>Insurance</td>
                                            <td id="nl_rs_10">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td>PMI</td>
                                            <td id="nl_rs_12">$0.00</td>
                                        </tr>
                                        <tr>
                                            <td style="border-bottom: 1px solid #6BC14B;">Rate</td>
                                            <td id="nl_rs_14" style="border-bottom: 1px solid #6BC14B;">$0.00</td>
                                        </tr>
                                    <tfoot>
                                        <tr>
                                            <td class="sp-txt-cl">TOTAL Payments</td>
                                            <td class="sp-txt-cl" id="nl_rs_16">$0.00</td>
                                        </tr>
                                    </tfoot>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        
                        <div class="col-md-12 middle-txt-sec">
                            <p class="middle-txt">Savings are based on the difference between your current monthly
                                payments
                                and the proposed loan payment</p>
                        </div>
                        <div class="col-md-12 foorter-rs-sec">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">Monthly Savings</h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_5">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">Yearly Savings</h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_6">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                        <div class="col-md-12 foorter-rs-sec-1">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">Years Removed with
                                                Current
                                                Payment</h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_9">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="rs-sec">
                                        <div class="rs-sp-vl-sec text-center">
                                            <h4 class="rs-sub-title-sp" style="color: #26459E;">Effective Interest Rate
                                            </h4>
                                            <h2 class="rs-sp-value" id="hm2_rs_10">$0.00</h2>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12"><br /></div>
                        <div class="col-md-6">
                            <label for="">APR:</label>
                            <div class="input-group">
                                <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="in_apr" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="">&nbsp;</label>
                                <button type="button" id="btn_download" class="btn btn-primary" style="width: 100%; background-color: blue; color: white;">⇓
                                    Download PDF</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="pdf_section">
        <div id="pdf_data">
            <p class="text-center">
                <img class="top-logo" id="my_logo" src="https://i.postimg.cc/RZDRnQv3/artwork-Mr-vector-01-20.png"
                    alt="" srcset="">
            </p>
            <p class="text-center" style="color: #000;font-size: 12px;">
                NMLS# 2322797
            </p>
            <div id="loan_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Original Loan</th>
                            <th></th>
                            <th></th>
                            <th>New Loan</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Original loan amount</td>
                            <td class="pdf-loan-vl" id="pdf_in_1">$0.00</td>
                            <td></td>
                            <td>New loan amount</td>
                            <td class="pdf-loan-vl" id="pdf_in_4">$0.00</td>
                        </tr>
                        <tr>
                            <td>Original Term (years)</td>
                            <td class="pdf-loan-vl" id="pdf_in_2">0</td>
                            <td></td>
                            <td>New Term (years)</td>
                            <td class="pdf-loan-vl" id="pdf_in_5">0</td>
                        </tr>
                        <tr>
                            <td>Current Rate</td>
                            <td class="pdf-loan-vl" id="pdf_in_3">0.000%</td>
                            <td></td>
                            <td>New Rate</td>
                            <td class="pdf-loan-vl" id="pdf_in_6">0.000%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="value_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width: 20%;">Value of home</th>
                            <th style="width: 20%;">Taxes</th>
                            <th style="width: 20%;">Insurance</th>
                            <th style="width: 15%;">PMI</th>
                            <th style="width: 15%;">APR</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="pdf_in_7">$0.00</td>
                            <td id="pdf_in_8">$0.00</td>
                            <td id="pdf_in_9">$0.00</td>
                            <td id="pdf_in_10">$0.00</td>
                            <td id="pdf_in_apr">0.00%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="value_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="pdf-rs-title">Current Payment</th>
                            <th class="pdf-rs-title">New Payment</th>
                            <th class="pdf-rs-title">Total Current Outflow</th>
                            <th class="pdf-rs-title">New Outflow</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="pdf-rs-vl" id="pdf_rs_1">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_2">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_3">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_4">$0.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="new_loan_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th>New Loan</th>
                        </tr>
                    </thead>
                </table>
                <table class="table" id="pdf_table_1">

                </table>
            </div>
            <table class="table" style="margin-bottom: 10px;">
                <thead>
                    <tr>
                        <th class="pdf-rs-title" style="text-align: left !important;">Savings</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="pdf-rs-vl" id="pdf_sv_rs_1" style="text-align: left !important;">$0.00</td>
                    </tr>
                </tbody>
            </table>
            <div id="debts_paid_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Debts to be paid</th>
                        </tr>
                    </thead>
                </table>
                <table class="table" id="pdf_table_2">
                </table>
            </div>
            <div id="pdf_txt_sec">
                <p style="font-size: 13px;">Savings are based on the difference between your current monthly payments
                    and
                    the proposed loan payment</p>
            </div>
            <div id="footer_rs_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="pdf-rs-title">Monthly Savings</th>
                            <th class="pdf-rs-title">Yearly Savings</th>
                            <th class="pdf-rs-title">5 Year Savings</th>
                            <th class="pdf-rs-title">Life of Loan Savings</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="pdf-rs-vl" id="pdf_rs_5">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_6">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_7">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_8">$0.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div id="bottom_footer_sec">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="pdf-rs-title" style="width: 50%;">Years Removed with Current Payment</th>
                            <th class="pdf-rs-title" style="width: 50%;">Cash Back at Closing</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="pdf-rs-vl" id="pdf_rs_9">$0.00</td>
                            <td class="pdf-rs-vl" id="pdf_rs_10">$0.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        
    </div>

    <footer style="background-color: #f8f9fa; padding: 40px 0; font-family: Arial, sans-serif; color: #333; padding-left: 200px; width: 100%;">
        <div style="display: flex; justify-content: center; align-items: center; padding: 0 15px;">
            <!-- Footer Container: Centered Content -->
            <div style="display: flex; justify-content: space-between; width: 100%; max-width: 1200px;">
                <!-- Left Side: Person Details -->
                <div style="flex: 1; display: flex; flex-direction: column; align-items: flex-start; max-width: 250px;">
                    <div style="margin-bottom: 20px;">
                        <img src="person1.png" alt="Person 1" style="width: 100px; height: 100px; border-radius: 50%; margin-bottom: 10px;">
                        <p><strong>name</strong><br>CEO & Founder</p>
                        <p>
                            <a href="https://linkedin.com/in/janesmith" target="_blank" style="color: #0073b1; text-decoration: none; margin-right: 10px;">
                                <i class="fab fa-linkedin-in" style="font-size: 24px;"></i>
                            </a> |
                            <a href="https://twitter.com/janesmith" target="_blank" style="color: #1da1f2; text-decoration: none; margin-right: 10px;">
                                <i class="fab fa-twitter" style="font-size: 24px;"></i>
                            </a>
                        </p>
                    </div>
                    <div>
                        <img src="person2.png" alt="Person 2" style="width: 100px; height: 100px; border-radius: 50%; margin-bottom: 10px;">
                        <p><strong>name</strong><br>COO</p>
                        <p>
                            <a href="https://linkedin.com/in/janesmith" target="_blank" style="color: #0073b1; text-decoration: none; margin-right: 10px;">
                                <i class="fab fa-linkedin-in" style="font-size: 24px;"></i>
                            </a> |
                            <a href="https://twitter.com/janesmith" target="_blank" style="color: #1da1f2; text-decoration: none; margin-right: 10px;">
                                <i class="fab fa-twitter" style="font-size: 24px;"></i>
                            </a>
                         </p>
                    </div>
                </div>
    
                <!-- Right Side: Certifications and Social Media Links -->
                <div style="flex: 2; display: flex; flex-direction: column; align-items: flex-start;">
                    <!-- Certifications -->
                    <div style="text-align: left; margin-bottom: 30px;">
                        <h4>About us</h4>
                        <div style="display: flex; justify-content: flex-start; gap: 20px; flex-wrap: wrap;">
                            <img src="about.png" alt="Certification 1" style="width: 550px; height: auto;">
                        </div>
                    </div>
    
                    <!-- Social Media Links with Icons -->
<div style="text-align: left;">
    <p>Follow Us:</p>
    <a href="https://www.facebook.com/yourcompany" target="_blank" style="color: #4267B2; text-decoration: none; margin-right: 10px;">
        <i class="fab fa-facebook-f" style="font-size: 24px;"></i>
    </a>
    <a href="https://www.linkedin.com/company/yourcompany" target="_blank" style="color: #0073b1; text-decoration: none; margin-right: 10px;">
        <i class="fab fa-linkedin-in" style="font-size: 24px;"></i>
    </a>
    <a href="https://www.twitter.com/yourcompany" target="_blank" style="color: #1da1f2; text-decoration: none; margin-right: 10px;">
        <i class="fab fa-twitter" style="font-size: 24px;"></i>
    </a>
    <a href="https://www.instagram.com/yourcompany" target="_blank" style="color: #E1306C; text-decoration: none; margin-right: 10px;">
        <i class="fab fa-instagram" style="font-size: 24px;"></i>
    </a>
</div>
                </div>
            </div>
        </div>
    </footer>
    

    
    <script src="https://cdn.jsdelivr.net/npm/autonumeric@4.5.4"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.8.0/html2pdf.bundle.min.js"></script>
    <script>
        jQuery(document).ready(function ($) {

            const xmlUpload = document.getElementById("xmlUpload");
    const dropZone = document.getElementById("dropZone");

    // Existing file input functionality
    xmlUpload.addEventListener("change", function (event) {
        handleFile(event.target.files[0]);
    });

    // Click functionality for the drop zone
    dropZone.addEventListener("click", () => {
        xmlUpload.click();
    });

    // Handle drag-and-drop functionality
    dropZone.addEventListener("dragover", (event) => {
        event.preventDefault(); // Prevent default browser behavior
        dropZone.style.backgroundColor = "#e0f7fa"; // Highlight drop zone
    });

    dropZone.addEventListener("dragleave", () => {
        dropZone.style.backgroundColor = ""; // Reset drop zone background
    });

    dropZone.addEventListener("drop", (event) => {
        event.preventDefault();
        dropZone.style.backgroundColor = ""; // Reset drop zone background

        const files = event.dataTransfer.files;
        if (files.length && files[0].type === "text/xml") {
            handleFile(files[0]); // Process the dropped file
        } else {
            alert("Please upload a valid XML file.");
        }
    });

    // Function to handle file reading and processing
    function handleFile(file) {
        if (file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                const xmlContent = e.target.result;
                parseAndPopulateFields(xmlContent); // Call the existing XML parsing function
            };

            reader.readAsText(file);
        } else {
            alert("Please select an XML file.");
        }
    }


            let totalHousingExpenses = 0;
let cashToBorrowerAtClosing = 0;
let noteAmount = 0;
let mortgageType = "";
let loanTermYears = 0;
let noteRatePercent = 0;
let liabilitiesData = [];



function parseAndPopulateFields(xmlContent) {
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xmlContent, "text/xml");

    // Extract all HousingExpensePaymentAmount values
    const amounts = Array.from(xmlDoc.getElementsByTagName("HousingExpensePaymentAmount"))
        .map(node => parseFloat(node.textContent));

    // Calculate the total sum of housing expenses
    totalHousingExpenses = amounts.reduce((sum, amount) => sum + amount, 0);

    // Extract <CashToBorrowerAtClosingAmount>
    const cashToBorrowerElement = xmlDoc.getElementsByTagName("CashToBorrowerAtClosingAmount")[0];
    if (cashToBorrowerElement) {
        cashToBorrowerAtClosing = parseFloat(cashToBorrowerElement.textContent).toFixed(2); // Save globally as a formatted string
    } else {
        cashToBorrowerAtClosing = "0.00"; // Default value if element is not found
    }


    // Extract <NoteAmount> value
    const noteAmountElement = xmlDoc.getElementsByTagName("NoteAmount")[0];
    if (noteAmountElement) {
        noteAmount = parseFloat(noteAmountElement.textContent).toFixed(2); // Save globally
    }

    // Extract <MortgageType>
    const mortgageTypeElement = xmlDoc.getElementsByTagName("MortgageType")[0];
    if (mortgageTypeElement) {
        mortgageType = mortgageTypeElement.textContent; // Save globally
    }

    // Extract <InitialFixedPeriodEffectiveMonthsCount> and convert to years
    const monthsElement = xmlDoc.getElementsByTagName("InitialFixedPeriodEffectiveMonthsCount")[0];
    if (monthsElement) {
        const months = parseInt(monthsElement.textContent, 10);
        loanTermYears = (months / 12).toFixed(1); // Convert to years and save globally
    }

    // Extract <NoteRatePercent>
    const rateElement = xmlDoc.getElementsByTagName("NoteRatePercent")[0];
    if (rateElement) {
        noteRatePercent = parseFloat(rateElement.textContent).toFixed(3); // Save globally with three decimal places
    }

    // Set extracted values in UI if needed
    AutoNumeric.getAutoNumericElement("#hm2_in_4").set(noteAmount); // Example for updating the UI
    AutoNumeric.getAutoNumericElement("#hm2_in_5").set(loanTermYears); // Update term years
    AutoNumeric.getAutoNumericElement("#hm2_in_6").set(noteRatePercent); // Update note rate

    // Extract and populate liabilities as in the original function
    const liabilities = xmlDoc.getElementsByTagName("LIABILITY");

    // Get the tbody for the all debts table
    const allDebtsTable = document.getElementById("all_debts_sec");

    // Clear existing rows in the table
    allDebtsTable.innerHTML = "";

    Array.from(liabilities).forEach((liability, index) => {
        const accountNameElement = liability.getElementsByTagName("FullName")[0];
        const accountName = accountNameElement ? accountNameElement.textContent : "N/A";

        const liabilityTypeElement = liability.getElementsByTagName("LiabilityType")[0];
        const liabilityType = liabilityTypeElement ? liabilityTypeElement.textContent : "N/A";

        const balanceAmountElement = liability.getElementsByTagName("LiabilityUnpaidBalanceAmount")[0];
        const balanceAmount = balanceAmountElement
            ? parseFloat(balanceAmountElement.textContent).toFixed(2)
            : "0.00";

        const paymentAmountElement = liability.getElementsByTagName("LiabilityMonthlyPaymentAmount")[0];
        const paymentAmount = paymentAmountElement
            ? parseFloat(paymentAmountElement.textContent).toFixed(2)
            : "0.00";

        const payoffStatusElement = liability.getElementsByTagName("LiabilityPayoffStatusIndicator")[0];
        const newPayment = payoffStatusElement && payoffStatusElement.textContent === "true" ? "0.00" : paymentAmount;

        const payoffStatus = payoffStatusElement && payoffStatusElement.textContent === "true" ? "Yes" : "No";

        // Store the liability data in the global array
        liabilitiesData.push({
            accountName,
            liabilityType,
            balanceAmount,
            currentPayment: paymentAmount,
            newPayment,
            payoffStatus
            
        });

        // Create a new row
        const row = document.createElement("tr");
        row.className = "debts-row";
        row.innerHTML = `
        <td>
            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="${accountName}">
        </td>
        <td>
            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="${paymentAmount}">
        </td>
        <td>
            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="${balanceAmount}">
        </td>
        <td>
            <select name="" class="tb-form-control debts-in hm2_cl-input">
                <option data-value="">--Select--</option>
                <option data-value="Yes" ${payoffStatus === "Yes" ? "selected" : ""}>Yes</option>
                <option data-value="No" ${payoffStatus === "No" ? "selected" : ""}>No</option>
            </select>
        </td>
    `;
        allDebtsTable.appendChild(row);
       
    });
    hm2_calc();
}

            const hm2_nft = Intl.NumberFormat("en-US", {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
            const hm2_nftd = Intl.NumberFormat("en-US", {
                minimumFractionDigits: 0,
                maximumFractionDigits: 2
            });

            const hm2_numOptionCurrency = {
                digitGroupSeparator: ',',
                decimalCharacter: '.',
                decimalCharacterAlternative: '.',
                currencySymbol: '',
                currencySymbolPlacement: AutoNumeric.options.currencySymbolPlacement.prefix,
                decimalPlaces: 0
            };
            const hm2_numOptionPercent = {
                digitGroupSeparator: ',',
                decimalCharacter: '.',
                decimalCharacterAlternative: '.',
                currencySymbol: '',
                currencySymbolPlacement: AutoNumeric.options.currencySymbolPlacement.suffix,
                decimalPlaces: 3,
                minimumValue: 0,
                maximumValue: 100
            };
            const anElement1 = AutoNumeric.multiple('.hm2_cl-curr', hm2_numOptionCurrency);
            const anElement2 = AutoNumeric.multiple('.hm2_cl-pr', hm2_numOptionPercent);

            $(".hm2_cl-input").on("input", function () {
                hm2_calc();
            });
            $(document).on("input", ".debts-in", function () {
                hm2_calc();
            });

            $("#add_debts_btn").on("click", function () {
                let debts_form = `<tr class="debts-row">
                                    <td>
                                        <input type="text" class="tb-form-control debts-in hm2_cl-input">
                                    </td>
                                    <td>
                                        <input type="text" class="tb-form-control debts-in hm2_cl-input">
                                    </td>
                                    <td>
                                        <input type="text" class="tb-form-control debts-in hm2_cl-input">
                                    </td>
                                    <td>
                                        <select name="" class="tb-form-control debts-in hm2_cl-input">
                                            <option data-value="">--Select--</option>
                                            <option data-value="Yes" selected>Yes</option>
                                            <option data-value="No">No</option>
                                        </select>
                                    </td>
                            </tr>`;

                $("#all_debts_sec").append(debts_form);
            });

            hm2_calc();

            $('#btn_download').on('click', function () {
                $(this).prop('disabled', true);
                $('#btn_download').text("Downloading....");
                genPDF();
                setTimeout(() => {
                    $('#btn_download').prop('disabled', false);
                    $('#btn_download').text("Download");
                }, 500);
            });

            var effective_interest_savings = 0;

async function genPDF() {
    try {
        // Fetch the external HTML file
        const response = await fetch('report_template.html');
        if (!response.ok) {
            throw new Error('Failed to fetch the HTML template.');
        }

        // Get the text content of the HTML
        const htmlContent = await response.text();

        // Create a temporary container to hold the fetched HTML
        const tempContainer = document.createElement('div');
        tempContainer.id = 'pdf_data';
        tempContainer.style.display = 'block';
        tempContainer.style.width = '800px'; // Set a fixed width for the container
        tempContainer.style.margin = '0 auto'; // Center the container
        tempContainer.style.pageBreakInside = 'avoid';
        tempContainer.innerHTML = htmlContent;


        //population
        // Update the container with the dynamic total
        
        const new_payment1 = document.getElementById("hm2_rs_4")?.textContent || "$0.00";
        const proposedPaymentElement = tempContainer.querySelector("#new-proposed-payment");
        if (proposedPaymentElement) {
            proposedPaymentElement.textContent = `${new_payment1}`;
        }

        // Populate the "CASH TO YOU" section with the extracted value
        const cashToYouElement = tempContainer.querySelector("#cash-to-you");
        if (cashToYouElement) {
            cashToYouElement.textContent = `$${cashToBorrowerAtClosing}`;
        } else {
            alert("Element with id 'cash-to-you' not found");
        }


        // Get the value from <td id="pdf_rs_3">
        const currentTotalPaymentsValue = document.getElementById("pdf_rs_3")?.textContent || "$0.00";

        // Populate the <p id="current-total-payments"> with the extracted value
        const currentTotalPaymentsElement = tempContainer.querySelector("#current-total-payments");
       
        if (currentTotalPaymentsElement) {
            currentTotalPaymentsElement.textContent = currentTotalPaymentsValue;
        } else {
            console.warn("Element with id 'current-total-payments' not found");
        }

        // Extract values from the source elements
        const monthlySavingsValue = document.getElementById("hm2_rs_5")?.textContent || "$0.00";
        const annualSavingsValue = document.getElementById("hm2_rs_6")?.textContent || "$0.00";
        const annualSavingsNumber = parseFloat(annualSavingsValue.replace(/[^0-9.-]+/g, "")) || 0;

        // Multiply annual savings by 5
        const calculatedFiveYearSavings = annualSavingsNumber * 5;
        const calc_5_val = "$" +  hm2_nftd.format(calculatedFiveYearSavings)
        const fiveYearSavingsValue = calc_5_val || "$0.00";

        // Populate the target elements in the tempContainer
        const monthlySavingsTarget = tempContainer.querySelector("#monthly-savings-value");
        if (monthlySavingsTarget) {
            monthlySavingsTarget.textContent = monthlySavingsValue;
        } else {
            console.warn("Element with id 'monthly-savings-value' not found in tempContainer");
        }

        const annualSavingsTarget = tempContainer.querySelector("#annual-savings-value");
        if (annualSavingsTarget) {
            annualSavingsTarget.textContent = annualSavingsValue;
        } else {
            console.warn("Element with id 'annual-savings-value' not found in tempContainer");
        }

        const fiveYearSavingsTarget = tempContainer.querySelector("#five-year-savings-value");
        if (fiveYearSavingsTarget) {
            fiveYearSavingsTarget.textContent = fiveYearSavingsValue;
        } else {
            console.warn("Element with id 'five-year-savings-value' not found in tempContainer");
        }

        const loanTypeElement = tempContainer.querySelector("#loan-type");
        if (loanTypeElement) {
            loanTypeElement.textContent = `PROPOSED LOAN: ${mortgageType} FIXED ${loanTermYears}    YEAR`;
        }

        const loanPaymentElement = tempContainer.querySelector("#loan-payment");
        if (loanPaymentElement) {
            loanPaymentElement.textContent = `$${noteAmount}`;
        }

        const aprElement = document.getElementById("pdf_in_apr");
        const aprValue = aprElement ? aprElement.textContent.trim() : "0.00%";



        const interestRateAprElement = tempContainer.querySelector("#interest-rate-apr");
        if (interestRateAprElement) {
            interestRateAprElement.textContent = `${noteRatePercent}% / ${aprValue}`;
        }

        const loanDetailsTableBody = tempContainer.querySelector("#loan-details-table tbody");

        if (loanDetailsTableBody) {
            // Clear any existing rows in the table body
            loanDetailsTableBody.innerHTML = "";

            // Add rows dynamically from liabilitiesData
            liabilitiesData.forEach((liability, index) => {  
                if (liability.payoffStatus === "Yes") { // Check if payoffStatus is "Yes"
                    const row = document.createElement("tr");
                    row.className = "debts-row";

                    row.innerHTML = `
                        <td class="p-2">${liability.accountName}</td>
                        <td class="p-2">${liability.liabilityType}</td>
                        <td class="p-2">${liability.balanceAmount}</td>
                        <td class="p-2">${liability.currentPayment}</td>
                        <td class="p-2">${liability.newPayment}</td>
                    `;

                    loanDetailsTableBody.appendChild(row);
                }
            });

        } else {
            console.warn("Table body for loan details not found in tempContainer.");
        }

        const debtTotal = $("#debts_paid_rs_1").text().trim() || "$0";
        const debtBalance = $("#debts_paid_rs_2").text().trim() || "$0";

        const loanTotalBalance = tempContainer.querySelector("#loan-total-balance");
        if (loanTotalBalance) {
            loanTotalBalance.textContent = debtBalance; // Populate balance
        }

        const loanTotalCurrentPayment = tempContainer.querySelector("#loan-total-current-payment");
        if (loanTotalCurrentPayment) {
            loanTotalCurrentPayment.textContent = debtTotal; // Populate total payment
        }

         // Calculate the sum of all liabilities' newPayment in liabilitiesData
         const totalNewPayment = liabilitiesData.reduce((sum, liability) => {
            return sum + parseFloat(liability.newPayment || 0);
        }, 0).toFixed(2);

        // Populate total new payment into the tempContainer
        const loanTotalNewPayment = tempContainer.querySelector("#loan-total-new-payment");
        if (loanTotalNewPayment) {
            loanTotalNewPayment.textContent = `$${totalNewPayment}`;
        }

         // Fetch values from the main document
         const totalMonthlySavings = document.getElementById("hm2_rs_5")?.textContent.trim() || "$0.00";
        const effectiveInterestSavings = document.getElementById("hm2_rs_8")?.textContent.trim() || "$0.00";
        const effectiveInterestRateElement = document.getElementById("hm2_rs_10");

        // Ensure the element exists and has a value property
        const effectiveInterestRate = effectiveInterestRateElement?.textContent.trim() || "0%";
        const savingsInYears = document.getElementById("pdf_rs_9")?.textContent.trim() || "0";

        // Populate values into the tempContainer
        const totalMonthlySavingsValue = tempContainer.querySelector("#total-monthly-savings-value");
        if (totalMonthlySavingsValue) {
            totalMonthlySavingsValue.textContent = totalMonthlySavings;
        }

        const effectiveInterestSavingsValue = tempContainer.querySelector("#effective-interest-savings-value");
        if (effectiveInterestSavingsValue) {
            effectiveInterestSavingsValue.textContent = effective_interest_savings;
        }

        const effectiveInterestRateValue = tempContainer.querySelector("#effective-interest-rate-value");
        if (effectiveInterestRateValue) {
            effectiveInterestRateValue.textContent = effectiveInterestRate;
        }

        const savingsInYearsValue = tempContainer.querySelector("#savings-in-years-value");
        if (savingsInYearsValue) {
            savingsInYearsValue.textContent = savingsInYears;
        }


        const style = document.createElement('style');
        style.textContent = `
            .pdf-container {
                letter-spacing: 0.01em;
                font-family: Arial, sans-serif;
                word-spacing: 0.01em;
            }
        `;
    document.head.appendChild(style);

    // Add the pdf-container class to tempContainer
    tempContainer.classList.add('pdf-container');

        document.body.appendChild(tempContainer);

        

        // Calculate content dimensions
        const contentWidth = tempContainer.offsetWidth;
        const contentHeight = tempContainer.offsetHeight;

        // Convert dimensions to PDF units
        const pdfWidth = 280; // A4 width in mm
        const pdfHeight = (contentHeight / contentWidth) * pdfWidth; // Scale height dynamically based on width

        const largePageHeight = Math.ceil(contentHeight * 0.264583) + 1000;


        // Generate a timestamp for the filename
        const d = new Date();
        const date_time = `${d.getMonth() + 1}_${d.getDate()}_${d.getFullYear()}_${d.getHours()}_${d.getMinutes()}_${d.getSeconds()}`;

        // Generate the PDF with a single page
        html2pdf(tempContainer, {
            margin: [5, 5, 5, 5],
            enableLinks: true,
            filename: `Loan_Calculator_${date_time}.pdf`,
            image: { type: "jpeg", quality: 1 },
            html2canvas: { scale: 6, logging: true, useCORS: true },
            jsPDF: { unit: "mm", format: [pdfWidth, largePageHeight], orientation: "portrait" },
        });

        // Clean up by removing the temporary container
        tempContainer.remove();
    } catch (error) {
        console.error('Error generating PDF:', error.message);
        alert('Failed to generate the PDF. Please try again.');
    }
}



            function hm2_calc() {
                console.log("Starting hm2_calc function");
                effective_interest_savings = 0;
                
                hm2_in_4 = hm2_removeSign($("#hm2_in_4").val());
                hm2_in_5 = hm2_removeSign($("#hm2_in_5").val());
                hm2_in_6 = hm2_removeSign($("#hm2_in_6").val()) / 100;
                hm2_in_8 = hm2_removeSign($("#hm2_in_8").val());
                hm2_in_9 = hm2_removeSign($("#hm2_in_9").val());
                hm2_in_10 = hm2_removeSign($("#hm2_in_10").val());

                let debt_rows = "";
                let debt_total = 0;
                let debt_balance = 0;
                let all_balance_total = 0;
                let no_total = 0;
                $(document).find(".debts-row").each(function (i, elm) {
                    let pr = $(elm);

                    let lender = pr.find("td:eq(0) .debts-in").val();
                    let payment = hm2_removeSign(pr.find("td:eq(1) .debts-in").val());
                    let balance = hm2_removeSign(pr.find("td:eq(2) .debts-in").val());
                    let paid = pr.find("td:eq(3) .debts-in").val();
                    all_balance_total = all_balance_total + payment;
                    if (paid == "Yes" && payment && balance) {
                        debt_total = debt_total + payment;
                        debt_balance = debt_balance + balance;

                        debt_rows = debt_rows + `
                        <tr>
                            <td>${lender}</td>
                            <td>$${hm2_nftd.format(payment)}</td>
                            <td>$${hm2_nftd.format(balance)}</td>
                        </tr>
                    `;
                    } else if (paid == "No") {
                        no_total = no_total + payment;
                    }
                });

                console.log("Final Debt Totals:");
                console.log(`  debt_total: ${debt_total}`);
                console.log(`  debt_balance: ${debt_balance}`);
                console.log(`  all_balance_total: ${all_balance_total}`);
                console.log(`  no_total: ${no_total}`);

                let total_current_outflow = all_balance_total;
                $("#hm2_rs_3, #pdf_rs_3").text("$" + hm2_nftd.format(debt_total));
                
                $("#debts_paid_sec").html(debt_rows);
                $("#debts_paid_rs_1").text("$" + hm2_nftd.format(debt_total));
                $("#debts_paid_rs_2").text("$" + hm2_nftd.format(debt_balance));

                let current_pi = PMT(0 / 12, 0 * 12, (-1 * 0));
                let propose_mortgage_bl = PMT(hm2_in_6 / 12, hm2_in_5 * 12, (-1 * hm2_in_4));

                console.log("Payment Calculations:");
                console.log(`  current_pi (Current P&I Payment): ${current_pi}`);
                console.log(`  propose_mortgage_bl (Proposed Mortgage Payment): ${propose_mortgage_bl}`);


                let current_paymenent = current_pi + hm2_in_8 + hm2_in_9 + hm2_in_10;
                let proposed_pmi = hm2_in_10;
                let new_payment = propose_mortgage_bl + hm2_in_8 + hm2_in_9 + proposed_pmi;

                console.log("Combined Payments:");
                console.log(`  current_paymenent: ${current_paymenent}`);
                console.log(`  new_payment: ${new_payment}`);


                
                let new_outflow = debt_total + new_payment;
                let current_total_payment = all_balance_total + current_paymenent;
                let proposed_total_payment = new_payment;
                let total_savings = current_total_payment - proposed_total_payment;
                let yearly_savings = total_savings * 12;
                let five_year_savings = yearly_savings * 5;
                let life_loan_savings = total_savings * (hm2_in_5 * 12);

                console.log("Outflow and Savings Calculations:");
                console.log(`  total_current_outflow: ${total_current_outflow}`);
                console.log(`  new_outflow: ${new_outflow}`);
                console.log(`  current_total_payment: ${current_total_payment}`);
                console.log(`  proposed_total_payment: ${proposed_total_payment}`);
                console.log(`  total_savings: ${total_savings}`);
                console.log(`  yearly_savings: ${yearly_savings}`);
                console.log(`  five_year_savings: ${five_year_savings}`);
                console.log(`  life_loan_savings: ${life_loan_savings}`);

                $("#hm2_rs_4, #pdf_rs_4").text("$" + hm2_nftd.format(new_payment));

                let new_monthly_saving = debt_total - proposed_total_payment
                let new_yearly_saving = (debt_total - proposed_total_payment)*12

                let new_paymnt = new_payment + debt_total;
                let total_new_payment = 0

                let year_remove_curr_payment = 0;

                let cash_back_closing = 0;


                console.log("New Payment Calculations:");
    console.log(`  new_paymnt: ${new_paymnt}`);
    console.log(`  total_new_payment: ${total_new_payment}`);
    console.log("Cash Back at Closing Calculation:");
    console.log(`  cash_back_closing: ${cash_back_closing}`);
    console.log(`  years removed curr payment: ${year_remove_curr_payment}`);


                

                // Calculate the year difference
                year_remove_curr_payment = 0;

                extra_payment = hm2_removeSign($("#extra_payment").val());

                if(extra_payment == 0){
                    year_remove_curr_payment = 0;
                }else if(extra_payment > 0){
                    // without extra payment
                    var c1 = calculateLoanDuration(hm2_in_4, hm2_in_6, hm2_in_5, new_payment).months;
                    // with extra payment
                    var c2 = calculateLoanDuration(hm2_in_4, hm2_in_6, hm2_in_5, (new_payment+extra_payment)).months;
                    var difference = c1 - c2;
                    year_remove_curr_payment = difference / 12;
                }

                var total_new_interest = calculateLoanDuration(hm2_in_4, hm2_in_6, hm2_in_5, new_payment).totalInterest;
                var total_new_interest_with_extra = total_new_interest
                if(extra_payment > 0){
                    total_new_interest_with_extra = calculateLoanDuration(hm2_in_4, hm2_in_6, hm2_in_5, (new_payment+extra_payment)).totalInterest;
                    console.log(` total_new_interest_with_extra: ${total_new_interest_with_extra}`);
                    effective_interest_savings = total_new_interest - total_new_interest_with_extra;
                    console.log(`  effective_interest_savings: ${effective_interest_savings}`);
                    
                }               

                // Calculate the total interest for the new payment plan
                
                console.log("Total new interest paid:", total_new_interest);
                
                let effective_interest_rate = ( total_new_interest_with_extra / total_new_interest ) * (hm2_in_6);

                console.log(`  effective_interest_rate: ${effective_interest_rate}`);
                
                final_effective_interest_rate = effective_interest_rate * 100; 

                $("#sv_rs_1, #pdf_sv_rs_1").text("$" + hm2_nftd.format(total_savings));
                $("#hm2_rs_1, #pdf_rs_1").text("$" + hm2_nftd.format(current_paymenent));
                $("#hm2_rs_2, #pdf_rs_2").text("$" + hm2_nft.format(new_payment));
                
                $("#hm2_rs_5, #pdf_rs_5").text("$" + hm2_nftd.format(new_monthly_saving));
                $("#hm2_rs_6, #pdf_rs_6").text("$" + hm2_nftd.format(new_yearly_saving));
                $("#hm2_rs_7, #pdf_rs_7").text("$" + hm2_nftd.format(five_year_savings));
                $("#hm2_rs_8, #pdf_rs_8").text("$" + hm2_nftd.format(life_loan_savings));
                $("#hm2_rs_9, #pdf_rs_9").text(hm2_nft.format(year_remove_curr_payment));
                $("#hm2_rs_10, #pdf_rs_10").text(hm2_nftd.format(final_effective_interest_rate)+"%");

                $("#nl_rs_1").text("$" + hm2_nftd.format(all_balance_total));
                $("#nl_rs_2").text(hm2_nftd.format(no_total));
                $("#nl_rs_4").text("$" + hm2_nftd.format(hm2_in_4));
                $("#nl_rs_6").text(hm2_nftd.format(hm2_in_5) + " Years");
                $("#nl_rs_8").text("$" + hm2_nftd.format(hm2_in_8));
                $("#nl_rs_10").text("$" + hm2_nftd.format(hm2_in_9));
                $("#nl_rs_12").text("$" + hm2_nftd.format(proposed_pmi));
                $("#nl_rs_14").text(hm2_nftd.format(hm2_in_6 * 100) + "%");
                $("#nl_rs_16").text("$" + hm2_nftd.format(proposed_total_payment));

                let table1 = $("#debts_loan_tb").html();
                let table2 = $("#debts_paid_tb").html();

                let in_apr = $("#in_apr").val();

                $("#pdf_table_1").html(table1);
                $("#pdf_table_2").html(table2);

                $("#pdf_in_4").text("$" + hm2_nftd.format(hm2_in_4));
                $("#pdf_in_5").text(hm2_in_5);
                $("#pdf_in_6").text(hm2_nftd.format(hm2_in_6 * 100) + "%");
                $("#pdf_in_8").text("$" + hm2_nftd.format(hm2_in_8));
                $("#pdf_in_9").text("$" + hm2_nftd.format(hm2_in_9));
                $("#pdf_in_10").text("$" + hm2_nftd.format(hm2_in_10));
                $("#pdf_in_apr").text(hm2_nftd.format(in_apr) + "%");
            }

            function hm2_removeSign(vl) {
                return Number(vl.replace(/,/g, ''));
            }

            function PMT(rate, nperiod, pv, fv, type) {
                if (!fv) fv = 0;
                if (!type) type = 0;

                if (rate == 0) return -(pv + fv) / nperiod;

                var pvif = Math.pow(1 + rate, nperiod);
                var pmt = rate / (pvif - 1) * -(pv * pvif + fv);

                if (type == 1) {
                    pmt /= (1 + rate);
                };

                return pmt;
            }

            function nper(rate, payment, present, future, type) {
                var type = (typeof type === 'undefined') ? 0 : type;

                var future = (typeof future === 'undefined') ? 0 : future;

                rate = eval(rate);

                var num = payment * (1 + rate * type) - future * rate;
                var den = (present * rate + payment * (1 + rate * type));
                return Math.log(num / den) / Math.log(1 + rate);
            }

            function toDataUrl(url, callback) {
                var xhr = new XMLHttpRequest();
                xhr.onload = function () {
                    var reader = new FileReader();
                    reader.onloadend = function () {
                        callback(reader.result);
                    }
                    reader.readAsDataURL(xhr.response);
                };
                xhr.open('GET', url);
                xhr.responseType = 'blob';
                xhr.send();
            }

            let src = $("#my_logo").attr("src");

            toDataUrl(src, function (myBase64) {
                $("#my_logo").attr("src", myBase64);
            });


            function calculateLoanDuration(originalAmount, interestRate, years, currentMonthlyPayment) {
    // Convert years to months
    const totalMonths = years * 12;

    // Initialize variables
    let balance = originalAmount; // Set balance to original amount
    let counter = 0; // Initialize counter
    let totalInterest = 0;

    // Loop until the balance (principal) is zero or less
    while (balance > 0) {
        // Calculate interest on balance (interest rate / 12 * balance)
        const interest = (interestRate / 12) * balance;

        totalInterest += interest;


        // Calculate principal (current monthly payment - interest)
        const principal = currentMonthlyPayment - interest;

        // Break the loop if the monthly payment cannot cover the interest
        if (principal <= 0) {
            console.log("The monthly payment is too low to pay off the loan.");
            break;
        }

        // Deduct the principal from the balance
        balance -= principal;

        // Increment the counter
        counter++;

        
    }

    // Print the counter (number of months to pay off the loan)
    console.log("Number of months to pay off the loan:", counter);

    return { months: counter, totalInterest: totalInterest.toFixed(2) };
}







        });
    </script>
    </script>

</body>

</html>